{"version":3,"sources":["../../src/store/store-handler.js"],"names":["StoreHandler","crypto","encryptExceptNames","namePrefix","store","name","includes","value","encrypted","setRaw","naming","shouldEncrypt","encrypt","def","getRaw","decrypt","set","JSON","stringify","get","parse","e","removeRaw","names","forEach","clearRaw"],"mappings":"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","sourcesContent":["export class StoreHandler {\r\n    /**\r\n     *\r\n     * @param {Crypto} crypto\r\n     * @param {String[]|String|null} encryptExceptNames\r\n     * @param {String} namePrefix\r\n     */\r\n    constructor(crypto, encryptExceptNames = null, namePrefix = '') {\r\n        this.crypto = crypto\r\n        this.encryptExceptNames = encryptExceptNames ?\r\n            (typeof encryptExceptNames === 'string' ? [encryptExceptNames] : encryptExceptNames) : null\r\n        this.store = {}\r\n        this.namePrefix = namePrefix\r\n    }\r\n\r\n    naming(name) {\r\n        return this.namePrefix + name\r\n    }\r\n\r\n    shouldEncrypt(name) {\r\n        return !this.encryptExceptNames\r\n            || (!this.encryptExceptNames.includes('*') && !this.encryptExceptNames.includes(name))\r\n    }\r\n\r\n    setRaw(name, value) {\r\n        this.store[name] = value\r\n    }\r\n\r\n    getRaw(name) {\r\n        return name in this.store ? this.store[name] : null\r\n    }\r\n\r\n    removeRaw(name) {\r\n        if (name in this.store) {\r\n            delete this.store[name]\r\n        }\r\n    }\r\n\r\n    clearRaw() {\r\n        this.store = {}\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {String} name\r\n     * @param {String} value\r\n     * @param {boolean|null} encrypted\r\n     * @returns {StoreHandler}\r\n     */\r\n    set(name, value, encrypted = null) {\r\n        this.setRaw(this.naming(name), (encrypted === null && this.shouldEncrypt(name)) || encrypted === true ?\r\n            this.crypto.encrypt(value) : value)\r\n        return this\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {String} name\r\n     * @param {String|null} def\r\n     * @param {boolean|null} encrypted\r\n     * @returns {String|null}\r\n     */\r\n    get(name, def = null, encrypted = null) {\r\n        const value = this.getRaw(this.naming(name))\r\n        return value ?\r\n            ((encrypted === null && this.shouldEncrypt(name)) || encrypted === true ?\r\n                this.crypto.decrypt(value) : value)\r\n            : def\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {String} name\r\n     * @param {Object} value\r\n     * @param {boolean|null} encrypted\r\n     * @returns {StoreHandler}\r\n     */\r\n    setJson(name, value, encrypted = null) {\r\n        return this.set(name, JSON.stringify(value), encrypted)\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {String} name\r\n     * @param {String|null} def\r\n     * @param {boolean|null} encrypted\r\n     * @returns {Object|null}\r\n     */\r\n    getJson(name, def = null, encrypted = null) {\r\n        const value = this.get(name, null, encrypted)\r\n        try {\r\n            return value ? JSON.parse(value) : def\r\n        } catch (e) {\r\n            return def\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {String} name\r\n     * @returns {StoreHandler}\r\n     */\r\n    remove(name) {\r\n        this.removeRaw(this.naming(name))\r\n        return this\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {String[]} names\r\n     * @returns {StoreHandler}\r\n     */\r\n    removeMany(names) {\r\n        names.forEach(name => this.removeRaw(this.naming(name)))\r\n        return this\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {StoreHandler}\r\n     */\r\n    clear() {\r\n        this.clearRaw()\r\n        return this\r\n    }\r\n}\r\n"],"file":"store-handler.js"}