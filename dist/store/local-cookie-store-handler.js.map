{"version":3,"sources":["../../src/store/local-cookie-store-handler.js"],"names":["LocalCookieStoreHandler","settings","crypto","encryptExceptNames","namePrefix","store","LocalStoreHandler","name","suffix","value","expires","path","domain","sameSite","Date","set","suffixNaming","toString","get","removeRaw","hostname","window","location","charAt","substring","length","pathname","indexOf","d","p","remove","clear","CookieStoreHandler"],"mappings":"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","sourcesContent":["import {CookieStoreHandler} from './cookie-store-handler'\r\nimport {LocalStoreHandler} from './local-store-handler'\r\n\r\nexport class LocalCookieStoreHandler extends CookieStoreHandler {\r\n    constructor(settings, crypto = null, encryptExceptNames = null, namePrefix = '__cookie_', store = null) {\r\n        super(settings, crypto, encryptExceptNames)\r\n\r\n        this.store = new LocalStoreHandler(null, null, namePrefix, store)\r\n    }\r\n\r\n    suffixNaming(name, suffix = null) {\r\n        return name + (suffix ? '__' + suffix : '')\r\n    }\r\n\r\n    setCookieRaw(name, value, expires = null, path = '/', domain = null, sameSite = 'lax') {\r\n        if (expires) {\r\n            if (expires <= new Date()) {\r\n                return this\r\n            }\r\n            this.store.set(this.suffixNaming(name, 'expires'), expires.toString())\r\n        }\r\n        this.store.set(this.suffixNaming(name, 'domain'), domain)\r\n        this.store.set(this.suffixNaming(name, 'path'), path)\r\n        this.store.set(this.suffixNaming(name), value)\r\n        return this\r\n    }\r\n\r\n    getCookieRaw(name) {\r\n        const expires = this.store.get(this.suffixNaming(name, 'expires'))\r\n        if (expires && new Date(expires) <= new Date()) {\r\n            this.removeRaw(name)\r\n            return null\r\n        }\r\n        const domain = this.store.get(this.suffixNaming(name, 'domain'))\r\n        const hostname = window.location.hostname\r\n        if (domain\r\n            && ((domain.charAt(0) === '.' && hostname.substring(hostname.length - domain.length) !== domain)\r\n                || (domain.charAt(0) !== '.' && hostname !== domain))) {\r\n            return null\r\n        }\r\n        const path = this.store.get(this.suffixNaming(name, 'path'))\r\n        const pathname = window.location.pathname\r\n        if (pathname.indexOf(path) !== 0) {\r\n            return null\r\n        }\r\n        return this.store.get(this.suffixNaming(name))\r\n    }\r\n\r\n    removeCookieRaw(name, path = '/', domain = null) {\r\n        const d = this.store.get(this.suffixNaming(name, 'domain'))\r\n        const p = this.store.get(this.suffixNaming(name, 'path'))\r\n        const hostname = window.location.hostname\r\n        if ((!d\r\n            || ((d.charAt(0) === '.' && hostname.substring(hostname.length - d.length) === d)\r\n                || (d.charAt(0) !== '.' && hostname === d)))\r\n            && path === p) {\r\n            this.store.remove(this.suffixNaming(name, 'expires'))\r\n            this.store.remove(this.suffixNaming(name, 'domain'))\r\n            this.store.remove(this.suffixNaming(name, 'path'))\r\n            this.store.remove(this.suffixNaming(name))\r\n        }\r\n        return this\r\n    }\r\n\r\n    clearCookieRaw() {\r\n        this.store.clear()\r\n        return this\r\n    }\r\n}"],"file":"local-cookie-store-handler.js"}