{"version":3,"sources":["../../src/store/local-cookie-store-handler.js"],"names":["LocalCookieStoreHandler","settings","crypto","encryptExceptNames","store","LocalStoreHandler","namePrefix","name","suffix","value","expires","path","domain","sameSite","Date","setRaw","naming","toString","getRaw","remove","hostname","window","location","charAt","substring","length","pathname","indexOf","d","p","removeRaw","i","localStorage","key","CookieStoreHandler"],"mappings":"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","sourcesContent":["import {CookieStoreHandler} from './cookie-store-handler'\r\nimport {LocalStoreHandler} from './local-store-handler'\r\n\r\nexport class LocalCookieStoreHandler extends CookieStoreHandler {\r\n    constructor(settings, crypto, encryptExceptNames = null) {\r\n        super(settings, crypto, encryptExceptNames)\r\n\r\n        this.store = new LocalStoreHandler(this.crypto, '*')\r\n        this.namePrefix = '___cookie_'\r\n    }\r\n\r\n    naming(name, suffix = null) {\r\n        return super.naming(name) + (suffix ? '___' + suffix : '')\r\n    }\r\n\r\n    setCookieRaw(name, value, expires = null, path = '/', domain = null, sameSite = 'lax') {\r\n        if (expires) {\r\n            if (expires <= new Date()) {\r\n                return\r\n            }\r\n            this.store.setRaw(this.naming(name, 'expires'), expires.toString())\r\n        }\r\n        this.store.setRaw(this.naming(name, 'domain'), domain)\r\n        this.store.setRaw(this.naming(name, 'path'), path)\r\n        this.store.setRaw(this.naming(name), value)\r\n    }\r\n\r\n    getCookieRaw(name) {\r\n        const expires = this.store.getRaw(this.naming(name, 'expires'))\r\n        if (expires && new Date(expires) <= new Date()) {\r\n            this.remove(name)\r\n            return null\r\n        }\r\n        const domain = this.store.getRaw(this.naming(name, 'domain'))\r\n        const hostname = window.location.hostname\r\n        if (domain\r\n            && ((domain.charAt(0) === '.' && hostname.substring(hostname.length - domain.length) !== domain)\r\n                || (domain.charAt(0) !== '.' && hostname !== domain))) {\r\n            return null\r\n        }\r\n        const path = this.store.getRaw(this.naming(name, 'path'))\r\n        const pathname = window.location.pathname\r\n        if (pathname.indexOf(path) !== 0) {\r\n            return null\r\n        }\r\n        return this.store.getRaw(this.naming(name))\r\n    }\r\n\r\n    removeCookieRaw(name, path = '/', domain = null) {\r\n        const d = this.store.getRaw(this.naming(name, 'domain'))\r\n        const p = this.store.getRaw(this.naming(name, 'path'))\r\n        const hostname = window.location.hostname\r\n        if ((!d\r\n            || ((d.charAt(0) === '.' && hostname.substring(hostname.length - d.length) === d)\r\n                || (d.charAt(0) !== '.' && hostname === d)))\r\n            && path === p) {\r\n            this.store.removeRaw(this.naming(name, 'expires'))\r\n            this.store.removeRaw(this.naming(name, 'domain'))\r\n            this.store.removeRaw(this.naming(name, 'path'))\r\n            this.store.removeRaw(this.naming(name))\r\n        }\r\n    }\r\n\r\n    clearCookieRaw() {\r\n        for (let i = 0; i < window.localStorage.length; ++i) {\r\n            const name = window.localStorage.key(i)\r\n            if (name.substring(0, this.namePrefix.length) === this.namePrefix) {\r\n                this.store.removeRaw(name)\r\n            }\r\n        }\r\n    }\r\n}"],"file":"local-cookie-store-handler.js"}