{"version":3,"sources":["../src/server-clock.js"],"names":["ServerClock","clockBlockKeys","clockBlockRange","clock","d","localClock","Math","floor","Date","getTime","callback","key","block","length"],"mappings":"wtBAAaA,CAAAA,W,yBACT,qBAAYC,cAAZ,CAA4BC,eAA5B,CAA6C,mCACzC,KAAKD,cAAL,CAAsBA,cAAtB,CACA,KAAKC,eAAL,CAAuBA,eAC1B,C,kEAEQC,K,CAAO,CACZ,KAAKC,CAAL,CAAS,KAAKC,UAAL,GAAoBF,KAChC,C,+CAEY,CACT,MAAOG,CAAAA,IAAI,CAACC,KAAL,CAAY,GAAIC,CAAAA,IAAJ,EAAD,CAAaC,OAAb,GAAyB,IAApC,CACV,C,qCAEO,CACJ,MAAO,MAAKJ,UAAL,GAAoB,KAAKD,CACnC,C,qCAEO,CACJ,MAAOE,CAAAA,IAAI,CAACC,KAAL,CAAW,KAAKJ,KAAL,GAAe,KAAKD,eAA/B,CACV,C,2CAEyB,IAAjBQ,CAAAA,QAAiB,2DAAN,IAAM,CACtB,GAAMC,CAAAA,GAAG,CAAG,KAAKV,cAAL,CAAoB,KAAKW,KAAL,GAAe,KAAKX,cAAL,CAAoBY,MAAvD,CAAZ,CACA,MAAOH,CAAAA,QAAQ,CAAGA,QAAQ,CAACC,GAAD,CAAX,CAAmBA,GACrC,C","sourcesContent":["export class ServerClock {\r\n    constructor(clockBlockKeys, clockBlockRange) {\r\n        this.clockBlockKeys = clockBlockKeys\r\n        this.clockBlockRange = clockBlockRange\r\n    }\r\n\r\n    setClock(clock) {\r\n        this.d = this.localClock() - clock\r\n    }\r\n\r\n    localClock() {\r\n        return Math.floor((new Date()).getTime() / 1000)\r\n    }\r\n\r\n    clock() {\r\n        return this.localClock() - this.d\r\n    }\r\n\r\n    block() {\r\n        return Math.floor(this.clock() / this.clockBlockRange)\r\n    }\r\n\r\n    blockKey(callback = null) {\r\n        const key = this.clockBlockKeys[this.block() % this.clockBlockKeys.length]\r\n        return callback ? callback(key) : key\r\n    }\r\n}\r\n\r\n"],"file":"server-clock.js"}