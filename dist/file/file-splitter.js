"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FileSplitter=void 0;var _progressHandler=require("../progress-handler");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var FileSplitter=/*#__PURE__*/function(){/**
     *
     * @param {File} file
     * @param {Number} chunkSize
     */function FileSplitter(file){var chunkSize=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1024*1024*2;_classCallCheck(this,FileSplitter);this.file=file;this.chunks=[];var numChunks=Math.ceil(file.size/chunkSize);for(var i=0;i<numChunks;++i){this.chunks.push(file.slice(i*chunkSize,(i+1)*chunkSize))}}_createClass(FileSplitter,[{key:"every",value:function every(callback){var _this=this;this.chunks.forEach(function(chunk,index){callback(chunk,index,_this.length())})}},{key:"length",value:function length(){return this.chunks.length}},{key:"upload",value:function upload(progressHandler,initCallback,chunkCallback){var _this2=this;return new Promise(function(resolve,reject){var remaining=_this2.length();progressHandler.reset().increaseLimit(remaining);_this2.every(function(chunkData,chunkIndex,chunkTotal){progressHandler.run(function(progressResolve,progressReject){chunkCallback(chunkData,chunkIndex,chunkTotal,function(){progressResolve();--remaining;if(remaining===0){resolve()}},function(){progressReject();reject()})})})})}}]);return FileSplitter}();exports.FileSplitter=FileSplitter;
//# sourceMappingURL=file-splitter.js.map