{"version":3,"sources":["../src/progress-handler.js"],"names":["ProgressHandler","ui","percentageTextTemplate","reset","delay","limit","current","percentage","completed","updatePercentageText","value","updateState","executor","increasedLimitValue","increaseLimit","Promise","then","increaseCurrent","Math","round","percentageText","replace","setTimeout","waitRendering","updatePercentage","updateCompleted"],"mappings":"4tBAAaA,CAAAA,e,yBACT,yBAAYC,EAAZ,CAAuD,IAAvCC,CAAAA,sBAAuC,2DAAd,YAAc,uCACnD,KAAKD,EAAL,CAAUA,EAAV,CACA,KAAKC,sBAAL,CAA8BA,sBAA9B,CAEA,KAAKC,KAAL,EACH,C,qFAE4B,IAAbC,CAAAA,KAAa,2DAAL,GAAK,CACzB,KAAKA,KAAL,CAAaA,KAAb,CAEA,MAAO,KACV,C,qCAEO,CACJ,KAAKC,KAAL,CAAa,CAAb,CACA,KAAKC,OAAL,CAAe,CAAf,CACA,KAAKC,UAAL,CAAkB,CAAlB,CACA,KAAKC,SAAL,CAAiB,KAAjB,CACA,KAAKJ,KAAL,CAAa,GAAb,CACA,KAAKK,oBAAL,GAEA,MAAO,KACV,C,oDAEaC,K,CAAO,CACjB,GAAIA,KAAJ,CAAW,CACP,KAAKL,KAAL,EAAcK,KAAd,CACA,KAAKC,WAAL,EACH,CAED,MAAO,KACV,C,wDAEeD,K,CAAO,CACnB,GAAIA,KAAJ,CAAW,CACP,KAAKJ,OAAL,EAAgBI,KAAhB,CACA,KAAKC,WAAL,EACH,CAED,MAAO,KACV,C,gCAEGC,Q,CAA8C,mBAApCF,CAAAA,KAAoC,2DAA5B,CAA4B,IAAzBG,CAAAA,mBAAyB,2DAAH,CAAG,CAC9CA,mBAAmB,EAAI,KAAKC,aAAL,CAAmBD,mBAAnB,CAAvB,CAEA,GAAIE,CAAAA,OAAJ,CAAYH,QAAZ,EAAsBI,IAAtB,CAA2B,UAAM,CAC7B,KAAI,CAACC,eAAL,CAAqBP,KAArB,CACH,CAFD,WAES,UAAM,CACX,KAAI,CAACI,aAAL,CAAmB,CAACJ,KAApB,CACH,CAJD,EAMA,MAAO,KACV,C,2DAEkB,CACf,KAAKH,UAAL,CAAkB,KAAKF,KAAL,GAAe,CAAf,CAAmB,CAAnB,CAAuBa,IAAI,CAACC,KAAL,CAAW,KAAKb,OAAL,CAAe,KAAKD,KAApB,CAA4B,GAAvC,CAAzC,CACA,MAAO,KACV,C,mEAEsB,CACnB,KAAKe,cAAL,CAAsB,MAAO,MAAKlB,sBAAZ,GAAuC,UAAvC,CAClB,KAAKA,sBAAL,CAA4B,KAAKK,UAAjC,CADkB,CAEhB,KAAKL,sBAAL,CAA4BmB,OAA5B,CAAoC,WAApC,CAAiD,KAAKd,UAAtD,CAFN,CAGA,MAAO,KACV,C,yDAEiB,iBACde,UAAU,CAAC,iBAAM,CAAA,MAAI,CAACd,SAAL,CAAiB,MAAI,CAACF,OAAL,GAAiB,MAAI,CAACD,KAA7C,CAAD,CAAqD,KAAKD,KAA1D,CAAV,CACA,MAAO,KACV,C,iDAEa,iBACV,KAAKH,EAAL,CAAQsB,aAAR,CAAsB,UAAM,CACxB,MAAI,CAACC,gBAAL,GACKf,oBADL,GAEKgB,eAFL,EAGH,CAJD,EAKA,MAAO,KACV,C","sourcesContent":["export class ProgressHandler {\r\n    constructor(ui, percentageTextTemplate = '{percent}%') {\r\n        this.ui = ui\r\n        this.percentageTextTemplate = percentageTextTemplate\r\n\r\n        this.reset()\r\n    }\r\n\r\n    delayCompletion(delay = 500) {\r\n        this.delay = delay\r\n\r\n        return this\r\n    }\r\n\r\n    reset() {\r\n        this.limit = 0\r\n        this.current = 0\r\n        this.percentage = 0\r\n        this.completed = false\r\n        this.delay = 500\r\n        this.updatePercentageText()\r\n\r\n        return this\r\n    }\r\n\r\n    increaseLimit(value) {\r\n        if (value) {\r\n            this.limit += value\r\n            this.updateState()\r\n        }\r\n\r\n        return this\r\n    }\r\n\r\n    increaseCurrent(value) {\r\n        if (value) {\r\n            this.current += value\r\n            this.updateState()\r\n        }\r\n\r\n        return this\r\n    }\r\n\r\n    run(executor, value = 1, increasedLimitValue = 0) {\r\n        increasedLimitValue && this.increaseLimit(increasedLimitValue)\r\n\r\n        new Promise(executor).then(() => {\r\n            this.increaseCurrent(value)\r\n        }).catch(() => {\r\n            this.increaseLimit(-value)\r\n        })\r\n\r\n        return this\r\n    }\r\n\r\n    updatePercentage() {\r\n        this.percentage = this.limit === 0 ? 0 : Math.round(this.current / this.limit * 100)\r\n        return this\r\n    }\r\n\r\n    updatePercentageText() {\r\n        this.percentageText = typeof this.percentageTextTemplate === 'function' ?\r\n            this.percentageTextTemplate(this.percentage)\r\n            : this.percentageTextTemplate.replace('{percent}', this.percentage)\r\n        return this\r\n    }\r\n\r\n    updateCompleted() {\r\n        setTimeout(() => this.completed = this.current === this.limit, this.delay)\r\n        return this\r\n    }\r\n\r\n    updateState() {\r\n        this.ui.waitRendering(() => {\r\n            this.updatePercentage()\r\n                .updatePercentageText()\r\n                .updateCompleted()\r\n        })\r\n        return this\r\n    }\r\n}"],"file":"progress-handler.js"}