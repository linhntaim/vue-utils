"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ProgressHandler=void 0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var ProgressHandler=/*#__PURE__*/function(){function ProgressHandler(ui){var percentageTextTemplate=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"{percent}%";_classCallCheck(this,ProgressHandler);this.ui=ui;this.percentageTextTemplate=percentageTextTemplate;this.reset()}_createClass(ProgressHandler,[{key:"delayCompletion",value:function delayCompletion(){var delay=arguments.length>0&&arguments[0]!==undefined?arguments[0]:500;this.delay=delay;return this}},{key:"reset",value:function reset(){this.limit=0;this.current=0;this.percentage=0;this.completed=false;this.delay=500;this.updatePercentageText();return this}},{key:"increaseLimit",value:function increaseLimit(value){if(value){this.limit+=value;this.updateState()}return this}},{key:"increaseCurrent",value:function increaseCurrent(value){if(value){this.current+=value;this.updateState()}return this}},{key:"run",value:function run(executor){var _this=this;var value=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var increasedLimitValue=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;increasedLimitValue&&this.increaseLimit(increasedLimitValue);new Promise(executor).then(function(){_this.increaseCurrent(value)})["catch"](function(){_this.increaseLimit(-value)});return this}},{key:"updatePercentage",value:function updatePercentage(){this.percentage=this.limit===0?0:Math.round(this.current/this.limit*100);return this}},{key:"updatePercentageText",value:function updatePercentageText(){this.percentageText=typeof this.percentageTextTemplate==="function"?this.percentageTextTemplate(this.percentage):this.percentageTextTemplate.replace("{percent}",this.percentage);return this}},{key:"updateCompleted",value:function updateCompleted(){var _this2=this;setTimeout(function(){return _this2.completed=_this2.current===_this2.limit},this.delay);return this}},{key:"updateState",value:function updateState(){var _this3=this;this.ui.waitRendering(function(){_this3.updatePercentage().updatePercentageText().updateCompleted()});return this}}]);return ProgressHandler}();exports.ProgressHandler=ProgressHandler;
//# sourceMappingURL=progress-handler.js.map