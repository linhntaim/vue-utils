{"version":3,"sources":["../../../src/cookie/cookie-handlers/local-cookie-handler.js"],"names":["LocalCookieHandler","crypto","settings","localCacheHandler","LocalCacheHandler","name","suffix","data","expires","path","domain","sameSite","Date","set","naming","toString","get","remove","charAt","window","location","hostname","substring","length","pathname","indexOf","names","i","d","p","CookieHandler"],"mappings":"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","sourcesContent":["import {CookieHandler} from './cookie-handler'\r\nimport {LocalCacheHandler} from '../../cache'\r\n\r\nexport class LocalCookieHandler extends CookieHandler {\r\n    constructor(crypto, settings) {\r\n        super(crypto, settings)\r\n\r\n        this.localCacheHandler = new LocalCacheHandler()\r\n    }\r\n\r\n    naming(name, suffix = null) {\r\n        return '___cookie_' + name + (suffix ? '___' + suffix : '')\r\n    }\r\n\r\n    setRaw(name, data, expires = null, path = '/', domain = null, sameSite = 'lax') {\r\n        if (expires) {\r\n            if (expires <= new Date()) {\r\n                return\r\n            }\r\n            this.localCacheHandler.set(this.naming(name, 'expires'), expires.toString())\r\n        }\r\n        this.localCacheHandler.set(this.naming(name, 'domain'), domain)\r\n        this.localCacheHandler.set(this.naming(name, 'path'), path)\r\n        this.localCacheHandler.set(this.naming(name), data)\r\n    }\r\n\r\n    getRaw(name) {\r\n        const expires = this.localCacheHandler.get(this.naming(name, 'expires'))\r\n        if (expires && new Date(expires) <= new Date()) {\r\n            this.remove([name])\r\n            return null\r\n        }\r\n        const domain = this.localCacheHandler.get(this.naming(name, 'domain'))\r\n        if (domain\r\n            && ((domain.charAt(0) === '.' && window.location.hostname.substring(window.location.hostname.length - domain.length) !== domain)\r\n                || (domain.charAt(0) !== '.' && window.location.hostname !== domain))) {\r\n            return null\r\n        }\r\n        const path = this.localCacheHandler.get(this.naming(name, 'path'))\r\n        if (window.location.pathname.indexOf(path) !== 0) {\r\n            return null\r\n        }\r\n        return this.localCacheHandler.get(this.naming(name))\r\n    }\r\n\r\n    removeRaw(names, path = '/', domain = null) {\r\n        for (const i in names) {\r\n            const name = names[i]\r\n            const d = this.localCacheHandler.get(this.naming(name, 'domain'))\r\n            const p = this.localCacheHandler.get(this.naming(name, 'path'))\r\n            if ((!d\r\n                || ((d.charAt(0) === '.' && window.location.hostname.substring(window.location.hostname.length - d.length) === d)\r\n                    || (d.charAt(0) !== '.' && window.location.hostname === d)))\r\n                && path == p) {\r\n                this.localCacheHandler.remove(this.naming(name, 'expires'))\r\n                this.localCacheHandler.remove(this.naming(name, 'domain'))\r\n                this.localCacheHandler.remove(this.naming(name, 'path'))\r\n                this.localCacheHandler.remove(this.naming(name))\r\n            }\r\n        }\r\n    }\r\n}"],"file":"local-cookie-handler.js"}